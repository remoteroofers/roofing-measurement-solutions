<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Create Account</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  font-family: Arial, sans-serif;
  background:#f4f6f8;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}

.card {
  background:#fff;
  padding:30px;
  width:380px;
  border-radius:8px;
  box-shadow:0 10px 25px rgba(0,0,0,.1);
}

input {
  width:100%;
  padding:10px;
  margin-bottom:10px;
}

.password-rules {
  font-size:12px;
  margin-bottom:10px;
}

.valid { color:green }
.invalid { color:red }

button {
  width:100%;
  padding:12px;
  background:#0a66c2;
  color:#fff;
  border:none;
  border-radius:5px;
  font-size:16px;
}

button:disabled {
  background:#aaa;
}
</style>
</head>

<body>

<div class="card">
  <h2>Create Account</h2>

  <input id="firstName" placeholder="First Name">
  <input id="lastName" placeholder="Last Name">
  <input id="email" placeholder="Email">

  <input id="phone" placeholder="Phone Number">

  <input id="password" type="password" placeholder="Password">
  <input id="confirmPassword" type="password" placeholder="Confirm Password">

  <label>
    <input type="checkbox" id="showPass"> Show Password
  </label>

  <div class="password-rules">
    <div id="length" class="invalid">• At least 8 characters</div>
    <div id="upper" class="invalid">• Uppercase letter</div>
    <div id="number" class="invalid">• Number</div>
    <div id="match" class="invalid">• Passwords match</div>
  </div>

  <button id="signupBtn" disabled>Create Account</button>
  <p id="msg"></p>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, sendEmailVerification } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const firebaseConfig = { /* YOUR CONFIG */ };
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const password = document.getElementById("password");
const confirm = document.getElementById("confirmPassword");
const signupBtn = document.getElementById("signupBtn");

function validate() {
  let pass = password.value;
  let ok = true;

  document.getElementById("length").className = pass.length >= 8 ? "valid":"invalid";
  document.getElementById("upper").className = /[A-Z]/.test(pass) ? "valid":"invalid";
  document.getElementById("number").className = /\d/.test(pass) ? "valid":"invalid";
  document.getElementById("match").className = pass === confirm.value && pass !== "" ? "valid":"invalid";

  ok = pass.length>=8 && /[A-Z]/.test(pass) && /\d/.test(pass) && pass===confirm.value;
  signupBtn.disabled = !ok;
}

password.oninput = confirm.oninput = validate;

document.getElementById("showPass").onchange = e => {
  password.type = confirm.type = e.target.checked ? "text" : "password";
};

signupBtn.onclick = async () => {
  try {
    const email = email.value;
    const pass = password.value;

    const userCred = await createUserWithEmailAndPassword(auth, email, pass);
    await sendEmailVerification(userCred.user);

    await setDoc(doc(db,"users",userCred.user.uid),{
      firstName:firstName.value,
      lastName:lastName.value,
      email,
      phone:phone.value,
      role:"user",
      created:new Date()
    });

    msg.innerHTML="✅ Verify your email to continue";
  } catch(e){ msg.innerHTML=e.message }
};
</script>
</body>
</html>
